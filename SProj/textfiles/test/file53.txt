TOPEKA, Kan. -  For weeks, a sense of frustration and desperation had hung heavy over the polished and airy Capitol here.With a $400 million budget hole looming and no clear plan to fill it, furloughs were threatened. An unfunded budget was passed, lawmakers raised the possibility of huge cuts to vital services like education, and the Republican majority split into factions and developed factions within those factions. And, in one instance, the House failed miserably to pass a tax increase even after locking its members into the chamber for hours while leaders tried to threaten some into changing their votes.On Thursday afternoon, Gov. Sam Brownback stood before his fellow Republicans, who dominate the Legislature, to deliver what seemed to be a mix of a basketball coach's pep talk and a scorned lover's plea. Standing rigid before a joint House-Senate caucus, with red eyes beneath glasses he doesn't usually wear in public, Mr. Brownback implored lawmakers at least three times to pass a tax plan to fund the state budget.'I'm pleading with you, really,' he said, splaying his palms out, 'to, just one more time, just get in the saddle, set aside maybe, 'I was right on this or you were wrong on that. You shouldn't have done this or you should have done that.' And say, 'We've just got to ride together. We've got to get in formation and we've got to get this done.'''The impasse ended Friday when the House and Senate came to an agreement, but not without some lasting bruises. It took 113 days to complete the session, the longest ever, and more than three weeks longer than the mandated 90 days.For years, government dysfunction in Washington has been a popular whipping post for Kansas lawmakers. But that gridlock overflowed here as lawmakers struggled to reach a deal, a surprising development considering that just three years ago Mr. Brownback won a major victory when a conservative slate of lawmakers he supported ousted moderate Republicans in primaries to give him a legislative majority that aligned with him philosophically.'You can assess blame a lot of ways and a lot of places, and I'll accept my share,' Mr. Brownback told the caucus on Thursday. 'But we are where we are. State's watching us. Country's watching us.'Susan Wagle, the Senate president, was blunt on Thursday afternoon in her assessment as she spoke to the caucus.'It's a crisis,' she said. 'We have not served Kansans well.'Much of the haggling over taxes comes after lawmakers passed about $3.8 billion worth of tax cuts in 2012 and 2013. Democrats and moderate Republicans have blamed those cuts for the budget shortfalls that have since arisen, while conservatives say it is because of unforeseen cost drivers out of their control like Medicaid growth. Yet some have also tentatively acknowledged that the only way to close the gap now was through tax increases, something that this mostly small-government body was loath to do. Eventually, they slowed down income tax decreases, raised sales taxes and increased the cigarette tax by 50 cents a pack, among other measures.But overcoming the gridlock to reach that deal required long legislative sessions stretching into the early morning.Senator Les Donovan, the tax committee chairman, said that fragmentation had been the worst he had seen in his more than two decades in Topeka.'One of the really big problems we're faced with right now is there are egos out there,' he said. 'They get their mind set, they want to put a cure for this problem and then they get stuck on that and they will not listen to anybody' else's reasoning.'The gridlock seemed to reach a low Thursday morning when the House failed to pass a Senate plan that leaders were optimistic would get through.That led to Thursday afternoon's caucus, during which legislative leaders and Mr. Brownback issued several threats about what could happen if a tax bill was not passed - for instance, cutting all state funding for public universities and colleges.After tweaking the bill, the House suspended its rules Thursday evening to allow it to stay in session through the morning.The tax plan was spread over two bills and the first passed at 1:51 a.m. Friday with exactly the 63 votes needed to pass. The second vote opened at 2:24. After an initial count of 59 yes votes, the lawmakers were locked into the chamber for the second time this week while leaders twisted arms. Because members must remain seated when the doors are locked, they worked the phones to try to change votes.Some members had quietly indicated that they would be the 63rd vote but did not want to change their votes before that. Several senior House members turned their eyes toward Rob Bruchman, who had voted 'yes' on the first bill but was a 'no' on this one. Mr. Bruchman was alternately whispering into his phone, smiling, leaning back in his seat, biting his bottom lip and sipping on a bottle of water.'He's just up there enjoying this,' an agitated Marvin Kleeb, the House tax chair, said to colleagues.At 4:05 a.m., an hour after the voting opened, Blake Carpenter, a freshman representative, reluctantly raised his hand to vote 'yes,' a move met with cheers and banging on desks. Mr. Carpenter rushed out of the chamber red faced as colleagues tried to console him.Later Friday, the Senate, in much quicker fashion, got exactly the 21 votes it needed to send the bill to the governor's desk. The impasse was over.